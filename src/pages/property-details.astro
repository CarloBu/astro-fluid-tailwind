---
import Layout from '../layouts/Layout.astro';
import { Picture } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import property1 from '../assets/property1.jpg';
import property1Interior from '../assets/property1-interior.jpg';
import property2 from '../assets/property2.jpg';
import property2Interior from '../assets/property2-interior.jpg';
import property3 from '../assets/property3.jpg';

interface StoryTextItem {
  type: 'text';
  content: string;
}

interface StoryImageItem {
  type: 'image';
  src: ImageMetadata;
  alt: string;
  caption?: string;
}

type StoryItem = StoryTextItem | StoryImageItem;

// Property Data (Mocked)
const property: {
  title: string;
  price: string;
  location: string;
  specs: {
    beds: number;
    baths: number;
    sqft: string;
    lot: string;
    yearBuilt: number;
  };
  description: string;
  story: StoryItem[];
} = {
  title: "Seabreeze Estate",
  price: "$8,950,000",
  location: "4280 Ocean Vista Drive, Malibu, USA",
  specs: {
    beds: 4,
    baths: 5,
    sqft: "5,200",
    lot: "1.2 Acres",
    yearBuilt: 2022
  },
  description: "Experience the pinnacle of coastal living at the Seabreeze Estate. This architectural masterpiece seamlessly blends modern luxury with the natural beauty of Malibu's shoreline. Designed with the 'Swiss Article' aesthetic in mind, every corner of this property tells a story of precision, light, and harmony.",
  story: [
    {
      type: 'text',
      content: "The Seabreeze Estate isn't just a house; it's a statement of intentional design. Inspired by the clarity of Swiss modernism, the structure uses clean lines and open volumes to frame the breathtaking Pacific views."
    },
    {
      type: 'image',
      src: property1Interior,
      alt: "Luminous living space with floor-to-ceiling windows",
      caption: "Natural light as a primary building material."
    },
    {
      type: 'text',
      content: "The heart of the home is the expansive living area, where the boundaries between indoors and outdoors dissolve. High ceilings and a neutral palette create an atmosphere of serene sophistication."
    },
    {
      type: 'image',
      src: property2,
      alt: "The pool deck at sunset",
      caption: "Twilight views over the Pacific horizon."
    },
    {
      type: 'text',
      content: "Craftsmanship is evident in every detail, from the hand-selected stone surfaces to the custom-milled woodwork. It's a sanctuary for those who appreciate the quiet power of exceptional architecture."
    }
  ]
};
---

<Layout title={`${property.title} | Property Details`}>
  <main class="pt-header-offset">
    <!-- Hero Section -->
    <section class="px-layout-margin py-fluid-16 flex flex-col gap-fluid-8">
      <div class="max-w-4xl">
        <h1 class="text-fluid-display uppercase tracking-tight mb-fluid-4">
          {property.title}
        </h1>
        <p class="text-fluid-title-sm font-light text-theme-fg-muted max-w-2xl">
          {property.description}
        </p>
      </div>
      
      <div class="aspect-21/9 w-full overflow-hidden">
        <Picture
          src={property1}
          formats={['avif', 'webp']}
          alt={property.title}
          class="w-full h-full object-cover"
        />
      </div>
    </section>

    <!-- Content Grid -->
    <section class="px-layout-margin pb-section-space">
      <div class="grid grid-cols-1 lg:grid-cols-4 gap-layout-gutter">
        
        <!-- Left Column: Story (3/4) -->
        <div class="lg:col-span-3 flex flex-col gap-fluid-16">
          <!-- Article Header -->
          <div class="flex flex-col gap-fluid-4 border-b border-theme-border pb-fluid-8">
            <div class="flex gap-fluid-6 text-fluid-caption text-theme-fg-muted">
              <span>Featured Property</span>
              <span>Architectural Series</span>
              <span>4 min read</span>
            </div>
          </div>

          <div class="flex flex-col gap-fluid-12">
            {property.story.map((item) => (
              item.type === 'text' ? (
                <p class="text-fluid-body-lg leading-relaxed text-theme-fg">
                  {item.content}
                </p>
              ) : (
                <figure class="flex flex-col gap-fluid-2 my-fluid-4">
                  <div class="overflow-hidden">
                    <Picture
                      src={item.src}
                      formats={['avif', 'webp']}
                      alt={item.alt}
                      class="w-full h-auto object-cover hover:scale-105 transition-transform duration-700"
                    />
                  </div>
                  {item.caption && (
                    <figcaption class="text-fluid-caption text-theme-fg-muted">
                      {item.caption}
                    </figcaption>
                  )}
                </figure>
              )
            ))}
          </div>
        </div>

        <!-- Right Column: Sidebar (1/4) -->
        <aside class="lg:col-span-1">
          <div class="sticky top-24 flex flex-col gap-fluid-12">
            <!-- Specifications -->
            <div class="flex flex-col gap-fluid-6">
              <div class="flex flex-col">
                <span class="text-fluid-caption text-theme-fg-muted">Price</span>
                <span class="text-fluid-title-sm font-medium">{property.price}</span>
              </div>
              
              <div class="grid grid-cols-2 gap-fluid-4 border-t border-theme-border pt-fluid-6">
                <div class="flex flex-col">
                  <span class="text-fluid-caption text-theme-fg-muted">Beds</span>
                  <span class="text-fluid-body font-medium">{property.specs.beds}</span>
                </div>
                <div class="flex flex-col">
                  <span class="text-fluid-caption text-theme-fg-muted">Baths</span>
                  <span class="text-fluid-body font-medium">{property.specs.baths}</span>
                </div>
                <div class="flex flex-col">
                  <span class="text-fluid-caption text-theme-fg-muted">Sq Ft</span>
                  <span class="text-fluid-body font-medium">{property.specs.sqft}</span>
                </div>
                <div class="flex flex-col">
                  <span class="text-fluid-caption text-theme-fg-muted">Lot Size</span>
                  <span class="text-fluid-body font-medium">{property.specs.lot}</span>
                </div>
              </div>

              <div class="flex flex-col border-t border-theme-border pt-fluid-6">
                <span class="text-fluid-caption text-theme-fg-muted">Location</span>
                <span class="text-fluid-body">{property.location}</span>
              </div>
            </div>

            <!-- CTA -->
            <div class="flex flex-col gap-fluid-4">
              <button class="w-full py-fluid-4 bg-theme-fg text-theme-bg text-fluid-caption font-bold tracking-widest hover:bg-theme-accent transition-colors uppercase">
                Schedule a Viewing
              </button>
              <button class="w-full py-fluid-4 border border-theme-fg text-theme-fg text-fluid-caption font-bold tracking-widest hover:bg-theme-bg-subtle transition-colors uppercase">
                Download Brochure
              </button>
            </div>

            <!-- Simple Comments/Inquiry Placeholder -->
            <div class="border-t border-theme-border pt-fluid-8">
              <h3 class="text-fluid-caption font-bold mb-fluid-4">Inquiries</h3>
              <div class="flex flex-col gap-fluid-4">
                <div class="p-fluid-4 bg-theme-bg-subtle rounded-theme-sm">
                  <p class="text-fluid-body-sm italic">"The use of light is spectacular. Is it available for private viewings?"</p>
                  <span class="text-fluid-caption mt-fluid-1 block text-theme-fg-muted">â€” Alex R.</span>
                </div>
                <form class="flex flex-col gap-fluid-3 mt-fluid-2">
                  <textarea 
                    placeholder="Ask a question..." 
                    class="w-full p-fluid-3 bg-transparent border border-theme-border rounded-theme-sm text-fluid-body-sm focus:outline-none focus:border-theme-accent min-h-[80px]"
                  ></textarea>
                  <button type="button" class="w-full py-fluid-2 bg-theme-fg text-theme-bg text-fluid-caption hover:bg-theme-accent transition-colors">
                    Send
                  </button>
                </form>
              </div>
            </div>

            <!-- Agent/Contact Small -->
            <div class="p-fluid-6 border border-theme-border rounded-theme-md flex flex-col gap-fluid-3">
              <span class="text-fluid-caption text-theme-fg-muted">Listed By</span>
              <div class="flex items-center gap-fluid-3">
                <div class="w-10 h-10 rounded-full bg-theme-bg-muted"></div>
                <div>
                  <p class="text-fluid-body font-medium leading-tight">Sarah Jenkins</p>
                  <p class="text-fluid-caption text-theme-fg-muted">Senior Associate</p>
                </div>
              </div>
            </div>
          </div>
        </aside>

      </div>
    </section>
  </main>
</Layout>
